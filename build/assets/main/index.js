System.register("chunks:///_virtual/AttackState.ts",["cc","./Bullet.ts","./NodePoolManager.ts","./DieState.ts"],(function(t){var e,n,a,o;return{setters:[function(t){e=t.cclegacy},function(t){n=t.Bullet},function(t){a=t.NodePoolManager},function(t){o=t.DieState}],execute:function(){e._RF.push({},"aaa2fTLg+hPtbyXbDwC38+E","AttackState",void 0);t("AttackState",function(){function t(){}var e=t.prototype;return e.enter=function(t){t.onAttack()},e.update=function(t,e){if(0!=t.Health){if(t.OnFight){t.setFight=!1;var i=a.getNodePoolMgr(),c=i.createNode("Bullet",t.node.parent,t.Bullet),u=c.getComponent(n);if(u.init(t.node.position,t.FaceToRight,t.PlayerID),u.setDestroyEvent(function(){c&&i.returnNode("Bullet",c)}.bind(this)),0==t.Health)return void t.stateMachine.changeState(new o);setTimeout((function(){0!=t.Health&&t.stateMachine.changeState(t.stateMachine.lastState)}),1e3*t.CoolDownTime)}}else t.stateMachine.changeState(new o)},e.exit=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Model.ts"],(function(n){var e,t,i,o,r,s,a,d,l,c,h,p,u,f;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){r=n.cclegacy,s=n._decorator,a=n.Node,d=n.Sprite,l=n.UITransform,c=n.tween,h=n.Vec3,p=n.Component},function(n){u=n.getValue,f=n.ModelKey}],execute:function(){var _,b,k,y,w,g,v;r._RF.push({},"78e4fBLX39My4qKPiKJQBAJ","BackgroundController",void 0);var m=s.ccclass,C=s.property;n("BackgroundController",(_=m("BackgroundController"),b=C(a),k=C(a),_((g=e((w=function(n){function e(){for(var e,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=n.call.apply(n,[this].concat(r))||this,i(e,"back_end",g,o(e)),i(e,"front_end",v,o(e)),e.backEndTween=null,e.frontEndTween=null,e}t(e,n);var r=e.prototype;return r.play=function(){var n=this;this.stop();for(var e=u(f.SpriteMap),t=0;t<2;t++){this.back_end.addChild(new a);var i=this.back_end.children[t].addComponent(d);null!=e&&(i.spriteFrame=e.get("seamless_ocean"));var o=this.back_end.children[t].getComponent(l).contentSize.width;this.back_end.children[t].setPosition(t*o,this.back_end.children[t].position.y,this.back_end.children[t].position.z),this.front_end.addChild(new a);var r=this.front_end.children[t].addComponent(d);null!=e&&(r.spriteFrame=e.get("seamless_road"));var s=this.front_end.children[t].getComponent(l).contentSize.width;this.front_end.children[t].setPosition(-t*s,this.front_end.children[t].position.y,this.front_end.children[t].position.z)}this.backEndTween=c(this.back_end).by(.2,{position:new h(-20,0,0)}).call((function(){n.back_end.position.x<=-1920&&n.back_end.setPosition(0,n.back_end.position.y)})).union().repeatForever().start(),this.frontEndTween=c(this.front_end).by(.2,{position:new h(20,0,0)}).call((function(){n.front_end.position.x>=1920&&n.front_end.setPosition(0,n.front_end.position.y)})).union().repeatForever().start()},r.stop=function(){this.backEndTween&&this.backEndTween.stop(),this.frontEndTween&&this.frontEndTween.stop(),this.back_end.children.length>0&&this.back_end.removeAllChildren(),this.front_end.children.length>0&&this.front_end.removeAllChildren()},r.start=function(){},r.update=function(n){},e}(p)).prototype,"back_end",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(w.prototype,"front_end",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=w))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Definition.ts","./Player.ts"],(function(t){var e,i,o,n,r,s,l,c,u,a,d,h,p,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,l=t._decorator,c=t.RigidBody2D,u=t.BoxCollider2D,a=t.Contact2DType,d=t.Vec2,h=t.Component},function(t){p=t.PHY_GROUP},function(t){f=t.Player}],execute:function(){var y,g,B,m,C,D,v;s._RF.push({},"c492d5weZ5C7IHmIiGtUi7T","Bullet",void 0);var w=l.ccclass,I=l.property;t("Bullet",(y=w("Bullet"),g=I({tooltip:"移動速度"}),B=I({tooltip:"傷害強度"}),y((D=e((C=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"moveSpeed",D,n(e)),o(e,"damage",v,n(e)),e.rigidBody=null,e.collider=null,e.isGoRight=!1,e.offset=62,e.rotationSpeed=135,e.delayTime=.5,e.ownerID="",e.destroyBullet=null,e}i(e,t);var s=e.prototype;return s.init=function(t,e,i){this.reset(),this.ownerID=i;var o=t;e?(this.isGoRight=!0,o.x+=this.offset):(this.isGoRight=!1,o.x-=this.offset),this.node.position=o},s.onLoad=function(){this.rigidBody=this.node.getComponent(c),this.collider=this.node.getComponent(u),this.collider&&(this.collider.on(a.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(a.END_CONTACT,this.onEndContact,this))},s.start=function(){},s.setDestroyEvent=function(t){this.destroyBullet=t},s.onBeginContact=function(t,e,i){if(e.group===p.PLAYER){var o=e.node.getComponent(f);if(this.ownerID==o.PlayerID)return;this.unschedule(this.destroyBullet),this.scheduleOnce(this.destroyBullet,0)}else this.unschedule(this.destroyBullet),this.scheduleOnce(this.destroyBullet,0)},s.onEndContact=function(t,e,i){},s.reset=function(){this.rigidBody.linearVelocity=new d(0,0)},s.update=function(t){var e=this.rigidBody.linearVelocity;this.isGoRight?e.x=this.moveSpeed:e.x=-this.moveSpeed,this.node.angle-=this.rotationSpeed*t,this.rigidBody.linearVelocity=e},r(e,[{key:"Damage",get:function(){return this.damage}},{key:"OwnerID",get:function(){return this.ownerID}}]),e}(h)).prototype,"moveSpeed",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),v=e(C.prototype,"damage",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),m=C))||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/CameraController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,o,r,s;return{setters:[function(t){i=t.inheritsLoose,e=t.createClass},function(t){o=t.cclegacy,r=t._decorator,s=t.Component}],execute:function(){var a;o._RF.push({},"edc7bxt9PNDIbhZxwt9SpqV","CameraController",void 0);var n=r.ccclass;r.property,t("CameraController",n("CameraController")(a=function(t){function o(){for(var i,e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return(i=t.call.apply(t,[this].concat(o))||this).player=null,i.cameraWidth=1920,i.cameraHeight=1080,i.bottomY=-540,i.cameraWidthOffset=240,i.isTouchLRBorder=!1,i}i(o,t);var r=o.prototype;return r.start=function(){},r.update=function(t){if(this.player){var i=(this.cameraWidth+this.cameraWidthOffset)/2,e=this.cameraHeight/2;if(this.player.position.y-e>=this.bottomY){var o=Math.abs(this.player.position.y-e-this.bottomY);this.node.setPosition(this.node.position.x,o)}this.isTouchLRBorder||this.node.setPosition(this.player.position.x,this.node.position.y),this.player.position.x+i>=this.cameraWidth+this.cameraWidthOffset||this.player.position.x-i<=-(this.cameraWidth+this.cameraWidthOffset)?this.isTouchLRBorder=!0:this.isTouchLRBorder=!1}},r.resetCamera=function(){this.player=null,this.node.setPosition(0,0,0)},e(o,[{key:"setPlayer",set:function(t){this.player=t,this.isTouchLRBorder=!1}}]),o}(s))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/Definition.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"152c6zyPWRI95b4PcrU6zjd","Definition",void 0);e("Action",function(e){return e.Join="1001",e.Move="1002",e.Stop="1003",e.Jump="1004",e.PositionInfo="1005",e.Attack="1006",e.Die="1007",e.Damage="1008",e.HealthBuff="1009",e.HealthGet="1010",e.Error="1011",e}({})),e("ActionReverseMap",{1001:"Join",1002:"Move",1003:"Stop",1004:"Jump",1005:"PositionInfo",1006:"Attack",1007:"Die",1008:"Damage",1009:"HealthBuff",1010:"HealthGet",1011:"Error"}),e("PHY_GROUP",{DEFAULT:1,FLOOR:2,PLAYER:4,BULLET:8,WALL:16,BUFF:32}),e("PlayerSetting",[{name:"ninja_maria"},{name:"ninja_shinzo"}]),e("MsgType",function(e){return e.WebSocketClose="WebSocketClose",e.NoPlayer="NoPlayer",e.PlayerIsLeft="PlayerIsLeft",e}({})),e("MsgCode",{WebSocketClose:"連線失敗！",NoPlayer:"尚未找到玩家，請重新連線。",PlayerIsLeft:"另一名玩家已斷線！"});t._RF.pop()}}}));

System.register("chunks:///_virtual/DieState.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"ae50bp9o2xNi4ekpMHu+es8","DieState",void 0);t("DieState",function(){function t(){}var e=t.prototype;return e.enter=function(t){t.onDie()},e.update=function(t,e){},e.exit=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,a;return{setters:[function(e){n=e.createForOfIteratorHelperLoose,t=e.createClass},function(e){a=e.cclegacy}],execute:function(){e("AddEvent",(function(e,n){r.addEventListener(i[e],n)})),a._RF.push({},"6fd8dKNCL1KhJ7CKxz5bmAc","EventManager",void 0);var r=e("EventManager",function(){function e(){this.eventMap=new Map}return e.addEventListener=function(e,n){var t;this.Instance.eventMap.has(e)||this.Instance.eventMap.set(e,[]),null==(t=this.Instance.eventMap.get(e))||t.push(n)},e.dispathEvent=function(e){for(var n=this,t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];var s=setTimeout((function(){var t;(t=n.Instance).dispatch.apply(t,[i[e]].concat(a)),clearTimeout(s),s=null}),0)},e.prototype.dispatch=function(e){if(this.eventMap.has(e)){for(var t=this.eventMap.get(e)||[],a=arguments.length,r=new Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];for(var s,c=n(t);!(s=c()).done;){var o=s.value;o.apply(void 0,r)}}},t(e,null,[{key:"Instance",get:function(){return null==e.instance&&(e.instance=new e),e.instance}}]),e}());r.instance=void 0;var i=e("EventName",function(e){return e[e.KeyDown=0]="KeyDown",e[e.KeyUp=1]="KeyUp",e[e.SyncPosition=2]="SyncPosition",e[e.TakeDamage=3]="TakeDamage",e[e.TakeHealth=4]="TakeHealth",e}({}));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameResult.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Model.ts"],(function(t){var e,n,r,o,i,u,c,a,l,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,u=t._decorator,c=t.Label,a=t.Component},function(t){l=t.getValue,s=t.ModelKey}],execute:function(){var p,f,y,h,g,b,w;i._RF.push({},"b44c2oXLJBL9qVJXss63tBG","GameResult",void 0);var d=u.ccclass,m=u.property;t("GameResult",(p=d("GameResult"),f=m(c),y=m(c),p((b=e((g=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return e=t.call.apply(t,[this].concat(i))||this,r(e,"score",b,o(e)),r(e,"countDown",w,o(e)),e}n(e,t);var i=e.prototype;return i.start=function(){},i.showScore=function(t){var e=l(s.PlayerUUID);this.score.string=e==t?"再接再厲!":"恭喜~你贏了!"},i.showCountDown=function(t){this.countDown.string=t.toString()},i.update=function(t){},e}(a)).prototype,"score",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(g.prototype,"countDown",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/GameScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./protobuf.mjs_cjs=&original=.js","./Player.ts","./EventManager.ts","./NodePoolManager.ts","./HealthBuff.ts","./WebSocketManager.ts","./Model.ts","./Definition.ts","./MenuScene.ts","./GameResult.ts","./MsgBox.ts","./CameraController.ts","./protobuf.js"],(function(e){var t,n,o,a,s,i,r,l,c,u,h,f,d,m,g,p,y,C,b,S,w,P,v,D,B,M,k,E,I,R,A,G,T,H,x;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){s=e.cclegacy,i=e._decorator,r=e.Node,l=e.Prefab,c=e.BoxCollider2D,u=e.UITransform,h=e.ProgressBar,f=e.Animation,d=e.Vec3,m=e.director,g=e.EventKeyboard,p=e.KeyCode,y=e.Label,C=e.Component},null,function(e){b=e.Player},function(e){S=e.EventManager,w=e.EventName},function(e){P=e.NodePoolManager},function(e){v=e.HealthBuff},function(e){D=e.WebSocketManager},function(e){B=e.getValue,M=e.ModelKey},function(e){k=e.PlayerSetting,E=e.Action,I=e.MsgType,R=e.MsgCode},function(e){A=e.MenuScene},function(e){G=e.GameResult},function(e){T=e.MsgBox},function(e){H=e.CameraController},function(e){x=e.default}],execute:function(){var N,L,K,_,z,W,O;s._RF.push({},"63fa6mzQSJId6LKlpwYnCAK","GameScene",void 0);var j=i.ccclass,U=i.property;e("GameScene",(N=j("GameScene"),L=U(r),K=U(l),N((W=t((z=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t=e.call.apply(e,[this].concat(s))||this,o(t,"players",W,a(t)),o(t,"healthBuff",O,a(t)),t.cameraController=null,t.gameResult=null,t.countDownTime=5,t.countDownStartTime=5,t.websocketConn=null,t.msgBox=null,t}n(t,e);var s=t.prototype;return s.onLoad=function(){this.gameResult=this.node.getChildByName("GameResult"),this.gameResult.active=!1,this.msgBox=this.node.getChildByName("MsgBox"),this.msgBox.getComponent(T).setCloseHandler(this.quitGameScene.bind(this)),this.cameraController=this.node.getChildByName("Camera").getComponent(H)},s.init=function(){this.websocketConn=D.getWebSocketConn,this.websocketConn.removeAllListener(),this.websocketConn.addListener("onopen",this.onOpen.bind(this)),this.websocketConn.addListener("onmessage",this.onMessage.bind(this)),this.websocketConn.addListener("onclose",this.onClose.bind(this)),this.setPlayerController(),this.players.forEach((function(e,t){var n=e.getComponent(b);e.getComponent(c).size.x=e.getComponent(u).contentSize.x*n.PlayerScale,e.getComponent(c).size.y=e.getComponent(u).contentSize.y*n.PlayerScale,e.getComponent(h).totalLength=e.getComponent(h).totalLength*n.PlayerScale,e.setScale(n.PlayerScale,n.PlayerScale,n.PlayerScale);var o=B(M.NinjaAnimation);e.getChildByName("Animation").getComponent(f).clips=o.get(k[t].name)}))},s.setPlayerController=function(){var e=this,t=B(M.JoinPacket),n=B(M.PlayerUUID);"start"==t.GameState&&t.AllPlayers.length>=2&&t.AllPlayers.forEach((function(t,o){var a=e.players[o].getComponent(b);a.setPlayerID=t,t==n?(console.log("我的ID為:",n,"使用腳色",[o]),a.setPlayerSelfControll=e.players[o],e.cameraController.setPlayer=e.players[o]):(console.log("另一個玩家ID是",t,"他使用腳色",[o]),a.setPlayerOtherControll=e.players[o])}))},s.onOpen=function(e){console.log("✅ [GameScene] 連線成功！",e)},s.onMessage=function(e){var t=this,n=new Uint8Array(e.data),o=n.slice(0,4),a=(new TextDecoder).decode(o),s=null,i=null;switch(a){case E.Move:s=n.slice(4),(i=x.protobuf.Move.decode(s)).IsGoRight?S.dispathEvent(w.KeyDown,i.ID,new g(p.ARROW_RIGHT,!0)):S.dispathEvent(w.KeyDown,i.ID,new g(p.ARROW_LEFT,!0));break;case E.Stop:s=n.slice(4),(i=x.protobuf.Stop.decode(s)).IsStopGoRight?S.dispathEvent(w.KeyUp,i.ID,new g(p.ARROW_RIGHT,!1)):S.dispathEvent(w.KeyUp,i.ID,new g(p.ARROW_LEFT,!1));break;case E.Jump:s=n.slice(4),i=x.protobuf.Jump.decode(s),S.dispathEvent(w.KeyDown,i.ID,new g(p.SPACE,!0));break;case E.PositionInfo:s=n.slice(4),i=x.protobuf.PositionInfo.decode(s);var r=new d(i.X,i.Y,0);S.dispathEvent(w.SyncPosition,i.ID,r);break;case E.Attack:s=n.slice(4),i=x.protobuf.Attack.decode(s),S.dispathEvent(w.KeyDown,i.ID,new g(p.KEY_X,!0));break;case E.Die:s=n.slice(4),i=x.protobuf.Die.decode(s),this.disablePlayer(),setTimeout((function(){t.cameraController.resetCamera(),t.gameResult.active=!0;var e=t.gameResult.getComponent(G);e.showScore(i.ID),t.schedule((function(){if(0==t.countDownTime)return t.resetPlayer(),void m.loadScene("MenuScene",t.switch2MenuScene.bind(t));e.showCountDown(t.countDownTime),t.countDownTime--}),1,5,0)}),2e3);break;case E.Damage:s=n.slice(4),i=x.protobuf.Damage.decode(s),S.dispathEvent(w.TakeDamage,i.ID,i.DamagePower);break;case E.HealthBuff:s=n.slice(4),i=x.protobuf.HealthBuff.decode(s);var l=new d(i.X,i.Y,0);this.generateHealthBuff(l);break;case E.HealthGet:s=n.slice(4),i=x.protobuf.HealthGet.decode(s),S.dispathEvent(w.TakeHealth,i.ID,i.Health);break;case E.Error:s=n.slice(4),i=x.protobuf.Error.decode(s),this.disablePlayer(),this.showMsgBox(I.PlayerIsLeft);break;default:console.error("未處理封包:",a)}},s.onClose=function(e){console.warn("❌ [GameScene] 連線已關閉"),this.showMsgBox(I.WebSocketClose),this.disablePlayer()},s.start=function(){},s.showMsgBox=function(e){this.msgBox.active=!0,this.msgBox.getChildByName("Content").getChildByName("message").getComponent(y).string=R[e]},s.quitGameScene=function(){this.resetPlayer(),this.cameraController.resetCamera(),m.loadScene("MenuScene",this.switch2MenuScene.bind(this))},s.switch2MenuScene=function(){var e=m.getScene().getChildByName("Canvas").getComponent(A);this.countDownTime=this.countDownStartTime,this.unscheduleAllCallbacks(),e&&e.reset()},s.generateHealthBuff=function(e){var t=P.getNodePoolMgr(),n=t.createNode("HealthBuff",this.node.getChildByName("HealthBuffCollection"),this.healthBuff);n.position=e;n.getComponent(v).setDestroyEvent(function(){n&&t.returnNode("HealthBuff",n)}.bind(this))},s.resetPlayer=function(){this.players.forEach((function(e){e.getComponent(b).resetPlayer()}))},s.disablePlayer=function(){this.players.forEach((function(e){e.getComponent(b).closePlayerControll=e}))},s.update=function(e){},t}(C)).prototype,"players",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=t(z.prototype,"healthBuff",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=z))||_));s._RF.pop()}}}));

System.register("chunks:///_virtual/HealthBuff.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Definition.ts"],(function(t){var e,n,o,i,r,l,c,s,a,u,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,r=t.createClass},function(t){l=t.cclegacy,c=t._decorator,s=t.RigidBody2D,a=t.BoxCollider2D,u=t.Contact2DType,h=t.Component},function(t){f=t.PHY_GROUP}],execute:function(){var d,p,y,g,B;l._RF.push({},"305e75KhotC+61OG8YIcKon","HealthBuff",void 0);var C=c.ccclass,H=c.property;t("HealthBuff",(d=C("HealthBuff"),p=H({tooltip:"補血量"}),d((B=e((g=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return e=t.call.apply(t,[this].concat(r))||this,o(e,"health",B,i(e)),e.rigidBody=null,e.collider=null,e.destroyHealthBuff=null,e}n(e,t);var l=e.prototype;return l.onLoad=function(){this.rigidBody=this.node.getComponent(s),this.collider=this.node.getComponent(a),this.collider&&(this.collider.on(u.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(u.END_CONTACT,this.onEndContact,this))},l.start=function(){},l.setDestroyEvent=function(t){this.destroyHealthBuff=t},l.onBeginContact=function(t,e,n){e.group===f.PLAYER&&(console.log("補到玩家:",e),this.scheduleOnce(this.destroyHealthBuff,0))},l.onEndContact=function(t,e,n){},l.update=function(t){},r(e,[{key:"Health",get:function(){return this.health}}]),e}(h)).prototype,"health",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=g))||y));l._RF.pop()}}}));

System.register("chunks:///_virtual/IdleState.ts",["cc","./AttackState.ts","./JumpState.ts","./WalkState.ts","./DieState.ts"],(function(t){var e,n,a,c,i;return{setters:[function(t){e=t.cclegacy},function(t){n=t.AttackState},function(t){a=t.JumpState},function(t){c=t.WalkState},function(t){i=t.DieState}],execute:function(){e._RF.push({},"9d612gaJrJPD4MQuVtY4GWZ","IdleState",void 0);t("IdleState",function(){function t(){}var e=t.prototype;return e.enter=function(t){t.onIdle()},e.update=function(t,e){0!=t.Health?((t.MoveLeft||t.MoveRight)&&t.stateMachine.changeState(new c),t.OnGround||t.stateMachine.changeState(new a),t.OnFight&&t.stateMachine.changeState(new n)):t.stateMachine.changeState(new i)},e.exit=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/IState.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"3ff263uPRhErazNnEIkCzMl","IState",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/JumpState.ts",["cc","./AttackState.ts","./IdleState.ts","./DieState.ts"],(function(t){var e,n,a,i;return{setters:[function(t){e=t.cclegacy},function(t){n=t.AttackState},function(t){a=t.IdleState},function(t){i=t.DieState}],execute:function(){e._RF.push({},"2ca957qeFtAs4yXvPRVISQD","JumpState",void 0);t("JumpState",function(){function t(){}var e=t.prototype;return e.enter=function(t){t.onJump()},e.update=function(t,e){if(0!=t.Health){var c=t.RigidBody.linearVelocity;t.MoveRight?c.x=t.WalkSpeed:t.MoveLeft?c.x=-t.WalkSpeed:c.x=0,t.RigidBody.linearVelocity=c,t.OnGround&&t.stateMachine.changeState(new a),t.OnFight&&t.stateMachine.changeState(new n)}else t.stateMachine.changeState(new i)},e.exit=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/LoadRes.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Model.ts"],(function(n){var e,t,r,i,a,o,s,c,u,l,p,f,d,h,x,m,v;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,r=n.initializerDefineProperty,i=n.assertThisInitialized,a=n.asyncToGenerator,o=n.regeneratorRuntime},function(n){s=n.cclegacy,c=n._decorator,u=n.Label,l=n.resources,p=n.AnimationClip,f=n.SpriteFrame,d=n.Component,h=n.ProgressBar},function(n){x=n.getValue,m=n.ModelKey,v=n.setValue}],execute:function(){var g,w,b,k,L;s._RF.push({},"0450fOTvT9ABZWTlqD/TG/T","LoadRes",void 0);var M=c.ccclass,y=c.property;n("LoadRes",(g=M("LoadRes"),w=y(u),g((L=e((k=function(n){function e(){for(var e,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return e=n.call.apply(n,[this].concat(a))||this,r(e,"loadingMsg",L,i(e)),e.progressBar=null,e.funcs=[e.loadMariaAnimationClips.bind(i(e)),e.loadShinzoAnimationClips.bind(i(e)),e.loadSprites.bind(i(e))],e.funcsIdx=0,e}t(e,n);var s=e.prototype;return s.onLoad=function(){},s.start=function(){},s.load=function(){var n=a(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,this.progressBar=this.node.getComponent(h),n.next=4,this.nextLoad("載入動畫 Maria",!0);case 4:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),s.loadMariaAnimationClips=function(){var n=this;return new Promise((function(e){l.loadDir("/animation_clips/ninja_maria",p,a(o().mark((function t(r,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}e(null),t.next=11;break;case 4:return null==(a=x(m.NinjaAnimation))&&(a=new Map),a.set("ninja_maria",i),v(m.NinjaAnimation,a),t.next=10,n.nextLoad("載入動畫 Shinzo",!0);case 10:e(i);case 11:case"end":return t.stop()}}),t)}))))}))},s.loadShinzoAnimationClips=function(){var n=this;return new Promise((function(e){l.loadDir("/animation_clips/ninja_shinzo",p,a(o().mark((function t(r,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}e(null),t.next=11;break;case 4:return null==(a=x(m.NinjaAnimation))&&(a=new Map),a.set("ninja_shinzo",i),v(m.NinjaAnimation,a),t.next=10,n.nextLoad("載入圖片",!0);case 10:e(i);case 11:case"end":return t.stop()}}),t)}))))}))},s.loadSprites=function(){var n=this;return new Promise((function(e){l.loadDir("/images/background",f,a(o().mark((function t(r,i){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}e(null),t.next=8;break;case 4:return i.forEach((function(n){var e=x(m.SpriteMap);null==e&&(e=new Map),e.set(n.name,n),v(m.SpriteMap,e)})),t.next=7,n.nextLoad("",!1);case 7:e(i);case 8:case"end":return t.stop()}}),t)}))))}))},s.loadTest=function(){var n=this;return new Promise((function(e){setTimeout(a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.nextLoad("",!1);case 2:e("success");case 3:case"end":return t.stop()}}),t)}))),3e3)}))},s.nextLoad=function(){var n=a(o().mark((function n(e,t){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===t&&(t=!1),console.log("準備載入:",e," 是否載入下一個資源:",t),!t){n.next=13;break}if(!(this.funcsIdx<this.funcs.length)){n.next=11;break}if(r=this.funcs[this.funcsIdx],this.funcsIdx++,!r){n.next=11;break}return this.loadingMsg.string=e,this.progressBar.progress=this.funcsIdx/this.funcs.length,n.next=11,r();case 11:n.next=15;break;case 13:this.node.active=!1,v(m.IsLoaded,!0);case 15:case"end":return n.stop()}}),n,this)})));return function(e,t){return n.apply(this,arguments)}}(),s.update=function(n){},e}(d)).prototype,"loadingMsg",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=k))||b));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Bullet.ts","./Socket.ts","./WebSocketConnection.ts","./WebSocketManager.ts","./BackgroundController.ts","./CameraController.ts","./Definition.ts","./AttackState.ts","./DieState.ts","./IState.ts","./IdleState.ts","./JumpState.ts","./StateMachine.ts","./WalkState.ts","./GameResult.ts","./GameScene.ts","./HealthBuff.ts","./LoadRes.ts","./MenuScene.ts","./Model.ts","./MsgBox.ts","./Player.ts","./EventManager.ts","./NodePoolManager.ts","./debug-view-runtime-control.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MenuScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Definition.ts","./protobuf.mjs_cjs=&original=.js","./GameScene.ts","./WebSocketManager.ts","./Model.ts","./Socket.ts","./LoadRes.ts","./BackgroundController.ts","./protobuf.js"],(function(e){var t,n,o,i,s,a,c,l,r,u,h,d,g,m,f,b,C,v,p,y,S,B,k,w,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,s=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,r=e.NodeEventType,u=e.tween,h=e.Label,d=e.director,g=e.Component},function(e){m=e.MsgType,f=e.MsgCode,b=e.Action},null,function(e){C=e.GameScene},function(e){v=e.WebSocketManager},function(e){p=e.setValue,y=e.ModelKey,S=e.getValue},function(e){B=e.Socket},function(e){k=e.LoadRes},function(e){w=e.BackgroundController},function(e){M=e.default}],execute:function(){var N,R,T,x,j;c._RF.push({},"0c3088STbFN0LjhmK7FyGfl","MenuScene",void 0);var L=l.ccclass,G=l.property;e("MenuScene",(N=L("MenuScene"),R=G(k),N((j=t((x=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,o(t,"loadRes",j,i(t)),t.websocketConn=null,t.join=null,t.quit=null,t.loadingRoom=null,t.searchingTime=1,t.searchTimeout=null,t.isGameStart=!1,t.msgBox=null,t.bgcInstance=null,t}n(t,e);var c=t.prototype;return c.onLoad=function(){this.websocketConn=v.getWebSocketConn,this.websocketConn.removeAllListener(),B.WebsocketConn=this.websocketConn,this.websocketConn.addListener("onopen",this.onOpen.bind(this)),this.websocketConn.addListener("onmessage",this.onMessage.bind(this)),this.websocketConn.addListener("onclose",this.onClose.bind(this)),this.join=this.node.getChildByName("Button").getChildByName("Join"),this.quit=this.node.getChildByName("Button").getChildByName("Quit"),this.loadingRoom=this.node.getChildByName("Button").getChildByName("LoadingRoom"),this.msgBox=this.node.getChildByName("MsgBox"),this.join.active=!0,this.quit.active=!1,this.loadingRoom.active=!1,this.msgBox.active=!1,this.bgcInstance=this.node.getChildByName("Background").getComponent(w),this.join.on(r.TOUCH_END,this.onJoin.bind(this)),this.quit.on(r.TOUCH_END,this.onQuit.bind(this))},c.start=function(){var e=s(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S(y.IsLoaded)){e.next=5;break}this.loadRes.node.active=!1,e.next=7;break;case 5:return e.next=7,this.loadRes.load();case 7:S(y.NinjaAnimation),S(y.SpriteMap),this.bgcInstance.play();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.activateButton=function(e){e.active=!0},c.deactivateButton=function(e){e.active=!1},c.onJoin=function(){var e=this;this.websocketConn.ReadyState!=WebSocket.CONNECTING&&this.websocketConn.ReadyState!=WebSocket.CLOSED?this.websocketConn.ReadyState==WebSocket.OPEN&&(B.sendJoinPacket(),this.deactivateButton(this.join),this.activateButton(this.quit),this.startSearch(),this.scheduleOnce((function(){e.loadingRoom.active=!0,u(e.loadingRoom).by(1,{angle:-360}).repeatForever().start()}))):this.showMsgBox(m.WebSocketClose)},c.onQuit=function(){B.sendQuit(),this.deactivateButton(this.quit),this.activateButton(this.join),this.loadingRoom.active=!1,this.unscheduleAllCallbacks(),null!=this.searchTimeout&&clearTimeout(this.searchTimeout)},c.startSearch=function(){var e=this;this.searchTimeout=setTimeout((function(){e.isGameStart||(B.sendQuit(),e.deactivateButton(e.quit),e.activateButton(e.join),e.loadingRoom.active=!1,e.unscheduleAllCallbacks(),e.showMsgBox(m.NoPlayer))}),1e3*this.searchingTime*60)},c.showMsgBox=function(e){this.msgBox.active=!0,this.msgBox.getChildByName("Content").getChildByName("message").getComponent(h).string=f[e]},c.reset=function(){this.join.active=!0,this.quit.active=!1,this.loadingRoom.active=!1,this.isGameStart=!1},c.onOpen=function(e){console.log("✅ [MenuScene] 連線成功！",e)},c.onMessage=function(e){var t=new Uint8Array(e.data),n=t.slice(0,4),o=(new TextDecoder).decode(n),i=null,s=null;switch(o){case b.Join:i=t.slice(4),s=M.protobuf.Join.decode(i),p(y.JoinPacket,s),null==S(y.PlayerUUID)&&(p(y.PlayerUUID,s.ID),console.log("我的uuid是:",S(y.PlayerUUID))),"start"==s.GameState&&s.AllPlayers.length>=2&&(this.quit.active=!1,this.isGameStart=!0,this.unscheduleAllCallbacks(),d.loadScene("GameScene",this.switch2GameScene.bind(this)));break;default:console.error("未處理封包:",o)}},c.onClose=function(e){console.warn("❌ [MenuScene] 連線已關閉"),this.showMsgBox(m.WebSocketClose)},c.switch2GameScene=function(){var e=d.getScene().getChildByName("Canvas").getComponent(C);e&&e.init()},c.update=function(e){},t}(g)).prototype,"loadRes",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=x))||T));c._RF.pop()}}}));

System.register("chunks:///_virtual/Model.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){e({getValue:function(e){var n=i(e);return a.has(n)?a.get(n):null},setValue:function(e,n){var t=i(e);a.set(t,n)}}),n._RF.push({},"dcb71BD7LBMv71K565ipFEO","Model",void 0);var t=e("ModelKey",function(e){return e[e.IsLoaded=0]="IsLoaded",e[e.NinjaClipMap=1]="NinjaClipMap",e[e.NinjaAnimation=2]="NinjaAnimation",e[e.SpriteMap=3]="SpriteMap",e[e.JoinPacket=4]="JoinPacket",e[e.PlayerUUID=5]="PlayerUUID",e}({})),a=new Map;function i(e){return"string"!=typeof e?t[e]:e}n._RF.pop()}}}));

System.register("chunks:///_virtual/MsgBox.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,t,n,i,s,l,r,a;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,i=e.Color,s=e.Node,l=e.Graphics,r=e.UITransform,a=e.Component}],execute:function(){var d;t._RF.push({},"978b0KPVPxFeq1xayMCg/st","MsgBox",void 0);var h=n.ccclass;n.property,e("MsgBox",h("MsgBox")(d=function(e){function t(){for(var o,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(o=e.call.apply(e,[this].concat(n))||this).closeHandler=null,o}o(t,e);var n=t.prototype;return n.onLoad=function(){this.drawBackgroundBody(),this.drawCloseButton(new i("#844200")),this.drawContentBody(),this.node.getChildByName("Close").on(s.EventType.TOUCH_START,this.onClose,this),this.node.getChildByName("Close").on(s.EventType.MOUSE_ENTER,this.onCloseEnter,this),this.node.getChildByName("Close").on(s.EventType.MOUSE_LEAVE,this.onCloseLeave,this)},n.start=function(){},n.setCloseHandler=function(e){this.closeHandler=e},n.onClose=function(e){this.closeHandler&&this.closeHandler(),this.node.active=!1},n.onCloseEnter=function(e){this.drawCloseButton(new i("#642100"))},n.onCloseLeave=function(e){this.drawCloseButton(new i("#844200"))},n.drawBackgroundBody=function(){var e=this.node.getChildByName("BackgroundBody").getComponent(l),o=e.node.getComponent(r).contentSize,t=-o.width/2,n=-o.height/2,s=o.width,a=o.height;e.clear(),e.roundRect(t,n,s,a,10),e.fillColor=new i("#FF8000"),e.fill()},n.drawCloseButton=function(e){var o=this.node.getChildByName("Close").getComponent(l);o.clear(),o.moveTo(-5,5),o.lineTo(5,-5),o.moveTo(5,5),o.lineTo(-5,-5),o.lineWidth=5,o.strokeColor=e,o.stroke()},n.drawContentBody=function(){var e=this.node.getChildByName("Content").getChildByName("Background").getComponent(l),o=e.getComponent(r).contentSize,t=-o.width/2,n=-o.height/2,s=o.width,a=o.height;e.clear(),e.rect(t,n,s,a),e.fillColor=new i("#844200"),e.fill()},n.update=function(e){},t}(a))||d);t._RF.pop()}}}));

System.register("chunks:///_virtual/NodePoolManager.ts",["cc"],(function(n){var o,e,t;return{setters:[function(n){o=n.cclegacy,e=n.NodePool,t=n.instantiate}],execute:function(){o._RF.push({},"1312bLUfQJA+pel4zOLT0hB","NodePoolManager",void 0),n("NodePoolManager",function(){function n(){this._nodePoolMap=new Map}n.getNodePoolMgr=function(){return null==this._instance&&(this._instance=new n),this._instance};var o=n.prototype;return o.checkNodePool=function(n){var o=null;return this._nodePoolMap.has(n)?o=this._nodePoolMap.get(n):(o=new e,this._nodePoolMap.set(n,o)),o},o.createNode=function(n,o,e){if(null!=n&&null!=e&&null!=o){var i=this.checkNodePool(n),c=null;return(c=0==i.size()?t(e):i.get()).parent=o,c}},o.returnNode=function(n,o){this.checkNodePool(n).put(o)},o.onDestroy=function(){this._nodePoolMap.forEach((function(n,o,e){n.size()>0&&n.clear()}))},n}())._instance=null,o._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./StateMachine.ts","./IdleState.ts","./Bullet.ts","./HealthBuff.ts","./Socket.ts","./Definition.ts"],(function(t){var e,i,n,o,l,s,a,h,r,c,u,p,f,y,d,g,m,C,v,S,k,D,P,b,T,B,A,E,w,R;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,l=t.createClass},function(t){s=t.cclegacy,a=t._decorator,h=t.Prefab,r=t.Node,c=t.Vec3,u=t.Animation,p=t.UITransform,f=t.ProgressBar,y=t.RigidBody2D,d=t.KeyCode,g=t.Vec2,m=t.ParticleSystem2D,C=t.Collider2D,v=t.Contact2DType,S=t.input,k=t.Input,D=t.Component},function(t){P=t.AddEvent,b=t.EventName},function(t){T=t.StateMachine},function(t){B=t.IdleState},function(t){A=t.Bullet},function(t){E=t.HealthBuff},function(t){w=t.Socket},function(t){R=t.PHY_GROUP}],execute:function(){var _,F,I,O,N,K,L,M,G,U,H,z,W,x,j,Y,V;s._RF.push({},"21cc4aMMQdGqJC6CnQxnNUj","Player",void 0);var q=a.ccclass,J=a.property;t("Player",(_=q("Player"),F=J({tooltip:"走路速度"}),I=J({tooltip:"跳躍力道"}),O=J(h),N=J(r),K=J({tooltip:"面朝方向"}),L=J(c),M=J({tooltip:"縮放比例"}),_((H=e((U=function(t){function e(){for(var e,i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return e=t.call.apply(t,[this].concat(l))||this,n(e,"walkSpeed",H,o(e)),n(e,"jumpForce",z,o(e)),n(e,"bullet",W,o(e)),n(e,"bleedEffect",x,o(e)),n(e,"faceToRight",j,o(e)),n(e,"spawnPoint",Y,o(e)),n(e,"playerScale",V,o(e)),e.stateMachine=null,e.animation=null,e._playerID="",e.player=null,e.moveRight=!1,e.moveLeft=!1,e.onFight=!1,e.canFight=!0,e.coolDownTime=.5,e.rigidBody=null,e.collider=null,e.onGround=!1,e.serverPosition=null,e.isSelfControl=!1,e.Delta=0,e.updateFrequency=.25,e.playerWidth=0,e.health=100,e.healthMax=100,e.healthProgressBar=null,e}i(e,t);var s=e.prototype;return s.onLoad=function(){this.animation=this.node.getChildByName("Animation").getComponent(u),this.playerWidth=this.node.getChildByName("Animation").getComponent(p).contentSize.width,this.healthProgressBar=this.node.getComponent(f),this.rigidBody=this.node.getComponent(y),P(b.KeyDown,this.onServerKeyDown.bind(this)),P(b.KeyUp,this.onServerKeyUp.bind(this)),P(b.SyncPosition,this.onSyncPosition.bind(this)),P(b.TakeDamage,this.onTakeDamage.bind(this)),P(b.TakeHealth,this.onTakeHealth.bind(this))},s.start=function(){this.stateMachine=new T(this,new B),this.flipPlayer()},s.resetPlayer=function(){this.unscheduleAllCallbacks(),this.player=null,this._playerID="",this.health=this.healthMax,this.healthProgressBar.progress=this.health/this.healthMax},s.onBeginContact=function(t,e,i){if(e.group===R.FLOOR)this.onGround=!0;else if(e.group===R.BULLET){var n=e.node.getComponent(A);if(this._playerID==n.OwnerID)return;var o=e.node.getComponent(A).Damage;this.isSelfControl&&w.sendDamagePacket(o)}else if(e.group===R.BUFF){var l=e.node.getComponent(E).Health;this.isSelfControl&&w.sendHealthGetPacket(l)}},s.onEndContact=function(t,e,i){e.group===R.FLOOR&&(this.onGround=!1)},s.resetFight=function(){this.canFight=!0},s.onKeyDown=function(t){switch(t.keyCode){case d.ARROW_RIGHT:this.isSelfControl&&w.sendMovePacket(!0),this.moveLeft&&(this.moveLeft=!1),this.moveRight=!0,this.faceToRight=!0,this.flipPlayer();break;case d.ARROW_LEFT:this.isSelfControl&&w.sendMovePacket(!1),this.moveRight&&(this.moveRight=!1),this.moveLeft=!0,this.faceToRight=!1,this.flipPlayer();break;case d.SPACE:this.isSelfControl&&w.sendJumpPacket(),this.onGround&&(this.rigidBody.linearVelocity=new g(this.rigidBody.linearVelocity.x,this.jumpForce),this.onGround=!1);break;case d.KEY_X:this.canFight&&(this.isSelfControl&&w.sendAttackPacket(),this.canFight=!1,this.onFight=!0,this.scheduleOnce(this.resetFight,this.coolDownTime))}},s.onKeyUp=function(t){switch(t.keyCode){case d.ARROW_RIGHT:this.isSelfControl&&w.sendStopPacket(!0),this.moveRight=!1;break;case d.ARROW_LEFT:this.isSelfControl&&w.sendStopPacket(!1),this.moveLeft=!1}},s.onServerKeyDown=function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1];this.isSelfControl||t==this._playerID&&this.onKeyDown(e)},s.onServerKeyUp=function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1];this.isSelfControl||t==this._playerID&&this.onKeyUp(e)},s.onSyncPosition=function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1];if(t==this._playerID){var i=this.player.position;this.player.position=i.lerp(e,.2)}},s.flipPlayer=function(){this.faceToRight?this.node.getChildByName("Animation").setScale(this.playerScale,this.playerScale,this.playerScale):this.node.getChildByName("Animation").setScale(-this.playerScale,this.playerScale,this.playerScale)},s.onTakeDamage=function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1];if(t==this._playerID){this.health-=e;var i=this.health/100;this.healthProgressBar.progress=i,this.bleedControll(),0==this.health&&this.isSelfControl&&w.sendDiePacket()}},s.onTakeHealth=function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1];if(t==this._playerID){if(this.health==this.healthMax)return;this.health+=e,console.log("玩家"+t+" 補血後血量"+this.health);var i=this.health/100;this.healthProgressBar.progress=i}},s.bleedControll=function(){if(this.bleedEffect.active=!this.bleedEffect.active,this.bleedEffect.active){var t=this.bleedEffect.getComponent(m);this.scheduleOnce(this.bleedControll.bind(this),t.life)}},s.onIdle=function(){this.stopAllAnimation(),this.animation.getState("idle").play()},s.onWalk=function(){this.stopAllAnimation(),this.animation.getState("run").play()},s.onJump=function(){this.stopAllAnimation(),this.animation.getState("jump").play()},s.onAttack=function(){this.stopAllAnimation(),this.animation.getState("throw").play()},s.onDie=function(){this.stopAllAnimation(),this.animation.getState("die").play()},s.stopAllAnimation=function(){var t=this;this.animation.clips.forEach((function(e){return t.animation.getState(e.name).stop()}))},s.update=function(t){this.Delta+=t,this.player&&(this.stateMachine.update(t),this.Delta>=this.updateFrequency&&(this.Delta=0,this.isSelfControl&&w.sendPosInfoPacket(this.player.position)))},l(e,[{key:"PlayerScale",get:function(){return this.playerScale}},{key:"MoveLeft",get:function(){return this.moveLeft}},{key:"MoveRight",get:function(){return this.moveRight}},{key:"FaceToRight",get:function(){return this.faceToRight}},{key:"OnGround",get:function(){return this.onGround}},{key:"OnFight",get:function(){return this.onFight}},{key:"setFight",set:function(t){this.onFight=t}},{key:"CoolDownTime",get:function(){return this.coolDownTime}},{key:"RigidBody",get:function(){return this.rigidBody}},{key:"WalkSpeed",get:function(){return this.walkSpeed}},{key:"Health",get:function(){return this.health}},{key:"Bullet",get:function(){return this.bullet}},{key:"setPlayerSelfControll",set:function(t){this.player=t,this.isSelfControl=!0,this.rigidBody=this.player.getComponent(y),this.collider=this.player.getComponent(C),this.collider&&(this.collider.on(v.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(v.END_CONTACT,this.onEndContact,this)),S.on(k.EventType.KEY_DOWN,this.onKeyDown,this),S.on(k.EventType.KEY_UP,this.onKeyUp,this)}},{key:"closePlayerControll",set:function(t){this.player=t,this.moveLeft=!1,this.moveRight=!1,this.rigidBody=this.player.getComponent(y),this.collider=this.player.getComponent(C),this.collider&&(this.collider.off(v.BEGIN_CONTACT,this.onBeginContact,this),this.collider.off(v.END_CONTACT,this.onEndContact,this)),S.off(k.EventType.KEY_DOWN,this.onKeyDown,this),S.off(k.EventType.KEY_UP,this.onKeyUp,this)}},{key:"setPlayerOtherControll",set:function(t){this.player=t,this.isSelfControl=!1,this.rigidBody=this.player.getComponent(y),this.collider=this.player.getComponent(C),this.collider&&(this.collider.on(v.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(v.END_CONTACT,this.onEndContact,this))}},{key:"setPlayerID",set:function(t){this._playerID=t}},{key:"PlayerID",get:function(){return this._playerID}}]),e}(D)).prototype,"walkSpeed",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),z=e(U.prototype,"jumpForce",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),W=e(U.prototype,"bullet",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(U.prototype,"bleedEffect",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(U.prototype,"faceToRight",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y=e(U.prototype,"spawnPoint",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(U.prototype,"playerScale",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),G=U))||G));s._RF.pop()}}}));

System.register("chunks:///_virtual/Socket.ts",["./rollupPluginModLoBabelHelpers.js","cc","./protobuf.mjs_cjs=&original=.js","./WebSocketConnection.ts","./Definition.ts","./Model.ts","./protobuf.js"],(function(e){var n,o,t,i,c,s,a;return{setters:[function(e){n=e.createClass},function(e){o=e.cclegacy},null,function(e){t=e.Packet},function(e){i=e.Action},function(e){c=e.getValue,s=e.ModelKey},function(e){a=e.default}],execute:function(){o._RF.push({},"e5b7aH0gAZL3as7BjNk41dn","Socket",void 0),e("Socket",function(){function e(){}return e.sendJoinPacket=function(){var e=new a.protobuf.Join;e.IsQuit=!1;var n=new t(i.Join,a.protobuf.Join.encode(e).finish());this.websocketConn.sendPacket(n)},e.sendQuit=function(){var e=new a.protobuf.Join;e.IsQuit=!0;var n=new t(i.Join,a.protobuf.Join.encode(e).finish());this.websocketConn.sendPacket(n)},e.sendMovePacket=function(e){var n=new a.protobuf.Move;n.ID=c(s.PlayerUUID),n.IsGoRight=e;var o=new t(i.Move,a.protobuf.Move.encode(n).finish());this.websocketConn.sendPacket(o)},e.sendStopPacket=function(e){var n=new a.protobuf.Stop;n.ID=c(s.PlayerUUID),n.IsStopGoRight=e;var o=new t(i.Stop,a.protobuf.Stop.encode(n).finish());this.websocketConn.sendPacket(o)},e.sendJumpPacket=function(){var e=new a.protobuf.Jump;e.ID=c(s.PlayerUUID);var n=new t(i.Jump,a.protobuf.Jump.encode(e).finish());this.websocketConn.sendPacket(n)},e.sendPosInfoPacket=function(e){var n=new a.protobuf.PositionInfo;n.ID=c(s.PlayerUUID),n.X=e.x,n.Y=e.y;var o=new t(i.PositionInfo,a.protobuf.PositionInfo.encode(n).finish());this.websocketConn.sendPacket(o)},e.sendAttackPacket=function(){var e=new a.protobuf.Attack;e.ID=c(s.PlayerUUID);var n=new t(i.Attack,a.protobuf.Attack.encode(e).finish());this.websocketConn.sendPacket(n)},e.sendDamagePacket=function(e){var n=new a.protobuf.Damage;n.ID=c(s.PlayerUUID),n.DamagePower=e;var o=new t(i.Damage,a.protobuf.Damage.encode(n).finish());this.websocketConn.sendPacket(o)},e.sendHealthGetPacket=function(e){var n=new a.protobuf.HealthGet;n.ID=c(s.PlayerUUID),n.Health=e;var o=new t(i.HealthGet,a.protobuf.HealthGet.encode(n).finish());this.websocketConn.sendPacket(o)},e.sendDiePacket=function(){var e=new a.protobuf.Die;e.ID=c(s.PlayerUUID);var n=new t(i.Die,a.protobuf.Die.encode(e).finish());this.websocketConn.sendPacket(n)},n(e,null,[{key:"WebsocketConn",set:function(e){this.websocketConn=e}}]),e}()).websocketConn=null,o._RF.pop()}}}));

System.register("chunks:///_virtual/StateMachine.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"67d06cvoXRMrI100fjrqr65","StateMachine",void 0);t("StateMachine",function(){function t(t,e){this.currentState=void 0,this.lastState=void 0,this.player=void 0,this.player=t,this.currentState=e,this.lastState=e,this.currentState.enter(t)}var e=t.prototype;return e.changeState=function(t){this.lastState=this.currentState,this.currentState.exit(this.player),this.currentState=t,this.currentState.enter(this.player)},e.update=function(t){this.currentState.update(this.player,t)},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/WalkState.ts",["cc","./AttackState.ts","./IdleState.ts","./JumpState.ts","./DieState.ts"],(function(t){var e,n,a,i,c;return{setters:[function(t){e=t.cclegacy},function(t){n=t.AttackState},function(t){a=t.IdleState},function(t){i=t.JumpState},function(t){c=t.DieState}],execute:function(){e._RF.push({},"ef1e1p7B4pHUZZytEDrKtzM","WalkState",void 0);t("WalkState",function(){function t(){}var e=t.prototype;return e.enter=function(t){t.onWalk()},e.update=function(t,e){if(0!=t.Health){var o=t.RigidBody.linearVelocity;t.MoveRight?o.x=t.WalkSpeed:t.MoveLeft?o.x=-t.WalkSpeed:o.x=0,t.RigidBody.linearVelocity=o,t.MoveLeft||t.MoveRight||t.stateMachine.changeState(new a),t.OnGround||t.stateMachine.changeState(new i),t.OnFight&&t.stateMachine.changeState(new n)}else t.stateMachine.changeState(new c)},e.exit=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/WebSocketConnection.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"7b664jGwbVBYoWJHFdQJvMK","WebSocketConnection",void 0);e("WebSocketConnection",function(){function e(){this._websocket=void 0,this._listener=new Map}var n=e.prototype;return n.connect=function(){var e=this;this._websocket=new WebSocket("ws://localhost:5000"),this._websocket.binaryType="arraybuffer",this._websocket.onopen=function(t){e.executListener("onopen",t)},this._websocket.onmessage=function(t){e.executListener("onmessage",t)},this._websocket.onclose=function(t){e.executListener("onclose",t)}},n.addListener=function(e,t){this._listener.set(e,t)},n.executListener=function(e,t){this._listener.get(e)(t)},n.removeAllListener=function(){this._listener&&this._listener.clear()},n.sendPacket=function(e){this.sendMessage(this.marshal(e))},n.marshal=function(e){var t=this.stringToUin8Array(e.action),n=new Uint8Array(t.length+e.body.length);return n.set(t,0),n.set(e.body,t.length),n},n.stringToUin8Array=function(e){var t=Uint8Array.from(Array.from(e).map((function(e){return e.charCodeAt(0)}))),n=new Uint8Array(t.length);return n.set(t,0),n},n.sendMessage=function(e){this._websocket&&this._websocket.readyState===WebSocket.OPEN?this._websocket.send(e):console.error("WebSocket 尚未連線")},t(e,[{key:"ReadyState",get:function(){return this._websocket.readyState}}]),e}()),e("Packet",(function(e,t){void 0===t&&(t=new Uint8Array(0)),this.action=e,this.body=t}));n._RF.pop()}}}));

System.register("chunks:///_virtual/WebSocketManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WebSocketConnection.ts"],(function(n){var e,t,c;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy},function(n){c=n.WebSocketConnection}],execute:function(){t._RF.push({},"c58698hcbpJ6qE/9YK7gctt","WebSocketManager",void 0),n("WebSocketManager",function(){function n(){}return e(n,null,[{key:"getWebSocketConn",get:function(){return this._instance||(this._instance=new c,this._instance.connect()),this._instance}}]),n}())._instance=null,t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});